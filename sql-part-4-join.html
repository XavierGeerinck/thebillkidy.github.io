<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>SQL - Part 4 - JOIN + Simulating Functions</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css">
    <style>.hljs { background: none; }</style>

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="My thoughts, tutorials and learnings" />
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="/sql-part-4-join" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Xavier Geerinck - Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="SQL - Part 4 - JOIN + Simulating Functions" />
    <meta property="og:description" content="When creating JOIN queries in SQL we have to realize that we are going to combine every result from the result set with the result set itself. This means that we are going to create a new result set that is the size of the power of 2 of our" />
    <meta property="og:url" content="/sql-part-4-join" />
    <meta property="og:image" content="/assets/images/covers/database.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2015-06-05T10:00:03+00:00" />
    <meta property="article:modified_time" content="2015-06-05T10:00:03+00:00" />
    <meta property="article:tag" content="Coding" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="SQL - Part 4 - JOIN + Simulating Functions" />
    <meta name="twitter:description" content="When creating JOIN queries in SQL we have to realize that we are going to combine every result from the result set with the result set itself. This means that we are going to create a new result set that is the size of the power of 2 of our" />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image" content="/assets/images/covers/database.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Xavier Geerinck - Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Coding" />
    <meta name="twitter:site" content="@XavierGeerinck" />
    <meta name="twitter:creator" content="@XavierGeerinck" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Xavier Geerinck - Blog",
        "logo": "/false"
    },
    "url": "/sql-part-4-join",
    "image": {
        "@type": "ImageObject",
        "url": "/assets/images/covers/database.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/sql-part-4-join"
    },
    "description": "When creating JOIN queries in SQL we have to realize that we are going to combine every result from the result set with the result set itself. This means that we are going to create a new result set that is the size of the power of 2 of our"
}
    </script>

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="SQL - Part 4 - JOIN + Simulating Functions" href="/feed.xml" />



    <!-- Enable MathJAX for LaTeX equations -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-about" role="menuitem"><a href="/projects">Projects</a></li>
    <li class="nav-about" role="menuitem"><a href="/demos">Demos</a></li>
    <li class="nav-about" role="menuitem"><a href="/categories">Categories</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
                <a class="social-link social-link-tw" href="https://twitter.com/XavierGeerinck" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
            
                <a class="social-link social-link-tw" href="https://linkedin.com/in/xaviergeerinck" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a>
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-sql ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 5 June 2015"> 5 June 2015</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/coding/'>CODING</a>,
                            
                        
                            
                               <a href='/tag/coding-sql/'>CODING-SQL</a>
                            
                        
                    
                </section>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/covers/database.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                        <h1 class="post-full-title">SQL - Part 4 - JOIN + Simulating Functions</h1>
                    <p>When creating JOIN queries in SQL we have to realize that we are going to combine every result from the result set with the result set itself. This means that we are going to create a new result set that is the size of the power of 2 of our original result set. (So if we have 1468 records, and we join it with itself, then we will get 2155024 records = 1468^2)</p>

<p>This is why it is a bad idea to use JOIN queries, however sometimes we have no other choice or our database engine does not support the better alternatives, and then we fall back to JOIN queries.</p>

<p>A better alternative when possible is to use CTE’s (Common Table Expressions), this is supported in both MSSQL and Oracle SQL</p>

<h2 id="get-the-number-of-alternatives-for-a-specific-result">Get the number of alternatives for a specific result</h2>

<p><strong>Use case:</strong> We want to get alternatives for a specific result that we found, but we can not use a ranking function and we want to solve this with a join.</p>

<p><strong>Example:</strong> Our result contains the name, nation and the altitude of SKI resorts, we want to find other ski resorts in the same nation but that have an altitude that is equal to or higher then the current one.</p>

<p><strong>Solution:</strong> To solve this, we just need to join and add our restrictions in that join. Which means that we have a restriction that the other resorts should be higher or equal, they should have another name but the nation should be the same</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">r1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">r1</span><span class="p">.</span><span class="n">nation</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">amount</span>
<span class="k">FROM</span> <span class="n">resorts</span> <span class="n">r1</span>
<span class="k">JOIN</span> <span class="n">resorts</span> <span class="n">r2</span> <span class="k">ON</span>
<span class="n">r1</span><span class="p">.</span><span class="n">name</span> <span class="o">&lt;&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">name</span>
<span class="k">AND</span> <span class="n">r1</span><span class="p">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">nation</span>
<span class="k">AND</span> <span class="n">r1</span><span class="p">.</span><span class="n">finishaltitude</span> <span class="o">&lt;=</span> <span class="n">r2</span><span class="p">.</span><span class="n">finishaltitude</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">r1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">r1</span><span class="p">.</span><span class="n">nation</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">r1</span><span class="p">.</span><span class="n">nation</span><span class="p">,</span> <span class="n">amount</span>
</code></pre></div></div>

<h2 id="produce-combinations-of-2-results-based-on-criteria">Produce combinations of 2 results based on criteria</h2>

<p><strong>Use case:</strong> When you want to combine 2 result with each other based on several criteria, then we can use a JOIN query to.</p>

<p><strong>Example:</strong> We have competitors and a ranking for the competitors. Our question is, how do we create a result that combines 2 competitors with each other with the following criteria:</p>

<ul>
  <li>They have points in a different discipline (table ranking, column discipline)</li>
  <li>They are born in the same year (table competitors, column birthdate)</li>
  <li>Their age difference is not more than 1 month (table competitors, column birthdate)</li>
  <li>They are both born before 1974 (table competitors, column birthdate)</li>
  <li>They both have a ranking in season 2006 (table ranking, column season))</li>
  <li>We have a combination of a women and a man (table competitors, gender and table ranking, column gender</li>
</ul>

<p><strong>Solution:</strong> We first need 2 rankings, so we join the rankings with each other and make sure that the disciplines are different, the gender of the ranking table is different and the CID is smaller then.</p>

<p>Once we have that we can say, join competitor c1 on the first ranking result, just by the cid column. And join competitors c2 on the second ranking result with the criteria that it has the same birthdate as competitor 1.</p>

<p>In our where we then check if the season is correct, that the months between are also smaller then 1 and that they are born before 1974.</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">distinct</span> <span class="n">c1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">to_char</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">birthdate</span><span class="p">,</span> <span class="s1">'DD-MON-YYYY'</span><span class="p">)</span> <span class="n">bday1</span><span class="p">,</span> <span class="n">c2</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">to_char</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">birthdate</span><span class="p">,</span> <span class="s1">'DD-MON-YYYY'</span><span class="p">)</span> <span class="n">bday2</span>
<span class="k">FROM</span> <span class="n">ranking</span> <span class="n">r1</span>
  <span class="k">JOIN</span> <span class="n">ranking</span> <span class="n">r2</span> <span class="k">ON</span> <span class="n">r1</span><span class="p">.</span><span class="n">cid</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">cid</span> <span class="k">AND</span> <span class="n">r1</span><span class="p">.</span><span class="n">gender</span> <span class="o">&lt;&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">gender</span> <span class="k">AND</span> <span class="n">r1</span><span class="p">.</span><span class="n">discipline</span> <span class="o">&lt;&gt;</span> <span class="n">r2</span><span class="p">.</span><span class="n">discipline</span>
  <span class="k">JOIN</span> <span class="n">competitors</span> <span class="n">c1</span> <span class="k">ON</span> <span class="n">r1</span><span class="p">.</span><span class="n">cid</span> <span class="o">=</span> <span class="n">c1</span><span class="p">.</span><span class="n">cid</span>
  <span class="k">JOIN</span> <span class="n">competitors</span> <span class="n">c2</span> <span class="k">ON</span> <span class="n">c2</span><span class="p">.</span><span class="n">cid</span> <span class="o">=</span> <span class="n">r2</span><span class="p">.</span><span class="n">cid</span>
    <span class="k">AND</span> <span class="k">EXTRACT</span><span class="p">(</span><span class="nb">year</span> <span class="k">FROM</span> <span class="n">c1</span><span class="p">.</span><span class="n">birthdate</span><span class="p">)</span> <span class="o">=</span> <span class="k">EXTRACT</span><span class="p">(</span><span class="nb">year</span> <span class="k">FROM</span> <span class="n">c2</span><span class="p">.</span><span class="n">birthdate</span><span class="p">)</span> <span class="c1">-- Same year born</span>
<span class="k">WHERE</span> <span class="n">r1</span><span class="p">.</span><span class="n">season</span> <span class="o">=</span> <span class="mi">2006</span>
  <span class="k">AND</span> <span class="n">r2</span><span class="p">.</span><span class="n">season</span> <span class="o">=</span> <span class="mi">2006</span>
  <span class="k">AND</span> <span class="k">ABS</span><span class="p">(</span><span class="n">MONTHS_BETWEEN</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">birthdate</span><span class="p">,</span> <span class="n">c2</span><span class="p">.</span><span class="n">birthdate</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span>
  <span class="k">AND</span> <span class="k">EXTRACT</span><span class="p">(</span><span class="nb">year</span> <span class="k">FROM</span> <span class="n">c1</span><span class="p">.</span><span class="n">birthdate</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1974</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">c1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">c2</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="top-n-problem">TOP N problem</h2>

<p><strong>Use case:</strong> Let’s say you want to get the TOP N of a specific result set, this can be done by using the ranking function, but again this function is not available in the database engine that you are using. This is where we again will use a JOIN query to solve this problem.</p>

<p><strong>Example:</strong> We need to get the top 5 heaviest men and women from a list of competitors, and this in separate columns.</p>

<p><strong>Solution:</strong> To create our solution, we have to combine the competitors on their own, but only select the competitors that weigh less then our current competitor. You can see this as a ranking simulation where we give a number 1 to the heaviest person and then decrease the number. Then on the end we just add a HAVING clause that checks for 5 results.</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">c1</span><span class="p">.</span><span class="n">name</span>
<span class="p">,</span> <span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">c1</span><span class="p">.</span><span class="n">gender</span> <span class="o">=</span> <span class="s1">'M'</span> <span class="k">THEN</span> <span class="n">TO_CHAR</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">weight</span><span class="p">)</span> <span class="k">ELSE</span> <span class="s1">' '</span> <span class="k">END</span><span class="p">)</span> <span class="n">MEN</span>
<span class="p">,</span> <span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">c1</span><span class="p">.</span><span class="n">gender</span> <span class="o">=</span> <span class="s1">'L'</span> <span class="k">THEN</span> <span class="n">TO_CHAR</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">weight</span><span class="p">)</span> <span class="k">ELSE</span> <span class="s1">' '</span> <span class="k">END</span><span class="p">)</span> <span class="n">WOMEN</span>
<span class="k">FROM</span> <span class="n">competitors</span> <span class="n">c1</span>
<span class="k">JOIN</span> <span class="n">competitors</span> <span class="n">c2</span> <span class="k">ON</span> <span class="n">c1</span><span class="p">.</span><span class="n">gender</span> <span class="o">=</span> <span class="n">c2</span><span class="p">.</span><span class="n">gender</span> <span class="k">AND</span> <span class="n">c1</span><span class="p">.</span><span class="n">weight</span> <span class="o">&lt;=</span> <span class="n">c2</span><span class="p">.</span><span class="n">weight</span>
<span class="k">WHERE</span> <span class="n">c1</span><span class="p">.</span><span class="n">weight</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">c1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">c1</span><span class="p">.</span><span class="n">gender</span><span class="p">,</span> <span class="n">c1</span><span class="p">.</span><span class="n">weight</span>
<span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">c1</span><span class="p">.</span><span class="n">weight</span> <span class="o">&lt;</span> <span class="n">c2</span><span class="p">.</span><span class="n">weight</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">c1</span><span class="p">.</span><span class="n">weight</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="simulating-the-max-function">Simulating the MAX() function</h2>

<p><strong>Use Case:</strong> Our database engine does not support the MAX function, how can we simulate this when we have access to the JOIN functions?</p>

<p><strong>Example:</strong> Let’s select the most used languages for each country.</p>

<p><strong>Solution:</strong> Since we do not have access to the MAX function we need to use our ranking simulation again that we used in the previous examples. So we assign a rank to each result, and then select where the rank is 1 and we return those results.</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">x</span><span class="p">.</span><span class="n">hasc</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">gebruik</span>
<span class="k">FROM</span> <span class="n">taalgebruik</span> <span class="n">x</span>
<span class="k">JOIN</span> <span class="n">taalgebruik</span> <span class="n">y</span> <span class="k">ON</span> <span class="n">x</span><span class="p">.</span><span class="n">hasc</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">hasc</span> <span class="k">AND</span> <span class="n">x</span><span class="p">.</span><span class="n">gebruik</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="p">.</span><span class="n">gebruik</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">hasc</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">gebruik</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">hasc</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="calculating-the-median">Calculating the Median</h2>

<p><strong>Use Case:</strong> You want to know the median of a result set.</p>

<p><strong>Example:</strong> Let’s say we have competitors from a nation with their weight, how do we get the median of the weight for each nation?</p>

<p><strong>Solution:</strong> We know that we get the median by subtracting the values bigger then with the values lower then our value and then comparing these to the values equal to. This way we get the median. So we allso apply this on our join queries to find it.</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">x</span><span class="p">.</span><span class="n">nation</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">weight</span>
<span class="k">FROM</span> <span class="n">competitors</span> <span class="n">x</span>
  <span class="k">JOIN</span> <span class="n">competitors</span> <span class="n">y</span> <span class="k">ON</span> <span class="n">x</span><span class="p">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">nation</span> 
<span class="k">WHERE</span> <span class="n">x</span><span class="p">.</span><span class="n">weight</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">y</span><span class="p">.</span><span class="n">weight</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">nation</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">weight</span>
<span class="k">HAVING</span>
  <span class="k">ABS</span><span class="p">(</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">y</span><span class="p">.</span><span class="n">weight</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">weight</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="o">-</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">y</span><span class="p">.</span><span class="n">weight</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">weight</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span>
  <span class="p">)</span> <span class="o">&lt;=</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">y</span><span class="p">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">weight</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="getting-results-that-are-not-in-another-table-without-using-set-operators">Getting results that are not in another table (without using set operators)</h2>

<p><strong>Use Case:</strong> You want to get the results that are not in another table, but you can’t use the set operator. Think about getting countries that do not belong to an international organization.</p>

<p><strong>Example:</strong> We want to find the countries that are not connected to an international organization.</p>

<p><strong>Solution:</strong> We select every country, and then we check if the left join of the international organisation returns a NULL value on one of the columns. We do this in the having clausule and if it returns NULL, then we return 1.</p>

<p><strong>Query:</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">r</span><span class="p">.</span><span class="n">name</span>
<span class="k">FROM</span> <span class="n">regios</span> <span class="n">r</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">members</span> <span class="n">m</span> <span class="k">on</span> <span class="n">m</span><span class="p">.</span><span class="n">hasc</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">hasc</span>
<span class="k">WHERE</span> <span class="k">level</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">r</span><span class="p">.</span><span class="n">name</span>
<span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">shortname</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="get-intervals-of-missing-numbers">Get intervals of missing numbers</h2>
<p><strong>Use Case:</strong> You want to be able to view all the missing numbers as an interval, for example: In a cinema, which seats are empty?</p>

<p><strong>Example:</strong> Find the missing elevations for the country Iceland (IS).</p>

<p><strong>Solution:</strong> For this problem it is better if we draw it. Imagine having a table like this:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
    </tr>
    <tr>
      <td style="text-align: center">10</td>
    </tr>
    <tr>
      <td style="text-align: center">11</td>
    </tr>
    <tr>
      <td style="text-align: center">12</td>
    </tr>
    <tr>
      <td style="text-align: center">14</td>
    </tr>
  </tbody>
</table>

<p>We can see that we got gaps here, numbers 5, 8, 9, 13 are missing. Now how can we get these numbers into a list?</p>

<p>For this we need to join the original query twice, once by selecting the values bigger then, and once to select the values between. Once we have this we can then create a result set that will return this:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">result</th>
      <th style="text-align: center">_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">9</td>
    </tr>
    <tr>
      <td style="text-align: center">13</td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>Which is the result we want.</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="o">+</span> <span class="mi">1</span> <span class="n">elevation</span><span class="p">,</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">-</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">2</span> <span class="k">THEN</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">END</span> <span class="nv">" "</span>
<span class="k">FROM</span> <span class="n">cities</span> <span class="n">x</span>
<span class="k">JOIN</span> <span class="n">cities</span> <span class="n">y</span> <span class="k">ON</span> <span class="n">y</span><span class="p">.</span><span class="n">iso</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span> <span class="k">AND</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="o">+</span> <span class="mi">1</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">cities</span> <span class="n">z</span> <span class="k">ON</span> <span class="n">z</span><span class="p">.</span><span class="n">iso</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span> <span class="k">AND</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="k">BETWEEN</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AND</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">-</span> <span class="mi">1</span>
<span class="k">WHERE</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span> <span class="o">=</span> <span class="s1">'IS'</span>
<span class="k">AND</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="k">AND</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="k">IS</span> <span class="k">NULL</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="get-intervals-of-connecting-numbers">Get intervals of connecting numbers</h2>

<p><strong>Use Case:</strong> You want to be able to view all the numbers that are connected to each other, for example: In a cinema, which seats are taken?</p>

<p><strong>Example:</strong> Find the connecting numbers as an interval for the country Iceland.</p>

<p><strong>Solution:</strong>
We use the same thinking method as we did for the problem with the missing numbers, instead we now have all the numbers there and need to find the connecting numbers, which means the left and right boundary.</p>

<p>For this we will also use 2 extra joins, 1 join will select all the results that are bigger then the current result, and the second will then find the result set between the non join and the join.</p>

<p>Once we did that we need to have a HAVING clausule that will give us the correct result.</p>

<p><strong>Query:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="n">elevation</span><span class="p">,</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">&lt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="k">THEN</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="k">END</span> <span class="nv">" "</span>
<span class="k">FROM</span> <span class="n">cities</span> <span class="n">x</span>
<span class="k">JOIN</span> <span class="n">cities</span> <span class="n">y</span> <span class="k">ON</span> <span class="n">y</span><span class="p">.</span><span class="n">iso</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span> <span class="k">AND</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span>
<span class="k">JOIN</span> <span class="n">cities</span> <span class="n">z</span> <span class="k">ON</span> <span class="n">z</span><span class="p">.</span><span class="n">iso</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span> <span class="k">AND</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="k">BETWEEN</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">AND</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">+</span> <span class="mi">1</span>
<span class="k">WHERE</span> <span class="n">x</span><span class="p">.</span><span class="n">iso</span> <span class="o">=</span> <span class="s1">'IS'</span>
<span class="k">AND</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span>
<span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="k">BETWEEN</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="k">AND</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="k">THEN</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="k">END</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">-</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="o">+</span> <span class="mi">1</span>
<span class="k">AND</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">AND</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">z</span><span class="p">.</span><span class="n">elevation</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">elevation</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">x</span><span class="p">.</span><span class="n">elevation</span><span class="p">;</span>
</code></pre></div></div>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/avatar.jpg" alt="xavier" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/xavier">Xavier Geerinck</a></h4>
                                
                                    <p>Xavier works as a Cloud Solution Architect at Microsoft, helping its customer unlock the full potential of the cloud. Even though he is still considered a young graduate, he achieved his first success at the age 16, by creating and selling his first startup. He then took this knowledge to create and help more startups in different markets such as technology, social media, philanthropy and home care. While in the meantime gaining more enterprise insights at renowned enterprises such as Nokia, Cisco and now Microsoft.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/xavier">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = window.location.href;
                            this.page.identifier = '/sql-part-4-join';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xaviergeerinck.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/covers/blog-cover.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Xavier Geerinck - Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/coding/">Coding</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/azure-automated-container-push">Create a script to deploy a container automatically with Azure Container Registry</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/stream-sampling">Sampling a real-time stream</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/minecraft-rfc-scanner">Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/coding/">
                                
                                    See all 30 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/sql-part-3-analytical">
                <div class="post-card-image" style="background-image: url(/assets/images/covers/database.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/sql-part-3-analytical">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Coding</span>
                            
                        
                            
                                <span class="post-card-tags">Coding-sql</span>
                            
                        
                    

                    <h2 class="post-card-title">SQL - Part 3 - Analytical Functions (Ranking, Rows, Over, ...)</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>Analytical Functions Analytical functions are brought into existence to solve the problems that we have with Aggregate functions. The biggest disadvantage of these Aggregate functions is that they always reduce the number of</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/avatar.jpg" alt="Xavier Geerinck" />
                        
                        <span class="post-card-author">
                            <a href="/author/xavier/">Xavier Geerinck</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/sql-part-5-cte">
                <div class="post-card-image" style="background-image: url(/assets/images/covers/database.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/sql-part-5-cte">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Coding</span>
                            
                        
                            
                                <span class="post-card-tags">Coding-sql</span>
                            
                        
                    

                    <h2 class="post-card-title">SQL - Part 5 - Common Table Expressions</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>CTE's (Common Table Expressions) are mostly used when creating recursive queries, creating temporary views (instead of subqueries). ## Calculating the dates of easter **Use case And Example:** We want to calculate the dates</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/avatar.jpg" alt="Xavier Geerinck" />
                        
                        <span class="post-card-author">
                            <a href="/author/xavier/">Xavier Geerinck</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            
        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/">
            
                <img src="/assets/images/favicon.png" alt="Xavier Geerinck - Blog icon" />
            
            <span>Xavier Geerinck - Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">SQL - Part 4 - JOIN + Simulating Functions</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=SQL+-+Part+4+-+JOIN+%2B+Simulating+Functions&amp;url=https://thebillkidy.github.io/sql-part-4-join"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://thebillkidy.github.io/sql-part-4-join"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
        <a class="floating-header-share-li" href="https://www.linkedin.com/shareArticle?mini=true&url=https://thebillkidy.github.io/sql-part-4-join&title=SQL+-+Part+4+-+JOIN+%2B+Simulating+Functions&source=https://thebillkidy.github.io/"
            onclick="window.open(this.href, 'share-linkedin','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Xavier Geerinck - Blog</a> &copy; 2020</section>
                <section class="poweredby">Made with ❤ in Belgium</section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    <a href="https://twitter.com/XavierGeerinck" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://linkedin.com/in/xaviergeerinck" target="_blank" rel="noopener">LinkedIn</a>
                </nav>
            </div>
        </footer>
    </div>

    <!-- The big email subscribe modal content -->
     

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
    <!-- <script>hljs.initHighlightingOnLoad();</script> -->

    <script>
        var blocks = document.querySelectorAll('div[class^=language-]');
        blocks.forEach((b) => {
            var language = b.className.split(" ")[0].match(/language\-(.*)/)[1];

            var codeBlocks = b.querySelectorAll('pre code');

            // Highlight the code
            codeBlocks.forEach((i) => {
                var text = i.innerText;
                var highlightedText = hljs.highlight(language, text);
                i.innerHTML = highlightedText.value;
            });

            // Add line numbers

            codeBlocks.forEach((i) => {            
                i.innerHTML = i.innerHTML.split("\n").map(function (i, idx, arr) {
                    // The last line seems to be empty, so don't work with it
                    if (idx == arr.length - 1) {
                        return '';
                    }

                    return '<span class="line-numbers"">' + i + '</span>' + "\n";
                }).join("");
            });
        });
    </script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.2.0/jquery.fitvids.min.js"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27398198-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

</body>
</html>
